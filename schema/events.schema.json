{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://github.com/princeton-orfe/orfe-upcoming/schema/events.schema.json",
  "title": "ORFE Upcoming Events",
  "description": "Schema for the JSON array produced by the transform/enrich pipeline.",
  "type": "array",
  "items": {
    "type": "object",
    "additionalProperties": true,
    "required": [
      "guid",
      "startTime",
      "endTime",
      "urlRef",
      "location",
      "title",
      "cancelled",
      "bannerImage",
      "itemType"
    ],
    "properties": {
      "guid": {
        "type": "string",
        "description": "Stable unique identifier from ICS UID (e.g., ps_events:11876:delta:0)."
      },
      "startTime": {
        "type": "string",
        "pattern": "^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}$",
        "description": "Event start in target timezone formatted as YYYY-MM-DDTHH:mm:ss (no timezone suffix)."
      },
      "endTime": {
        "type": "string",
        "pattern": "^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}$",
        "description": "Event end in target timezone formatted as YYYY-MM-DDTHH:mm:ss (no timezone suffix)."
      },
      "urlRef": {
        "type": "string",
        "format": "uri",
        "description": "URL to the event detail page."
      },
      "location": {
        "type": "object",
        "required": ["name", "id", "detail"],
        "additionalProperties": false,
        "properties": {
          "name": { "type": "string", "description": "Building or venue name." },
          "id": { "type": "string", "description": "Reserved for future canonical location id (may be empty)." },
          "detail": { "type": "string", "description": "Room or extra info (e.g., '101')." }
        }
      },
      "series": {
        "type": "string",
        "description": "Joined categories string (comma-separated) from ICS CATEGORIES."
      },
      "speaker": {
        "type": "string",
        "description": "ICS SUMMARY field with commas/semicolons escaped (\\, \\;)."
      },
      "content": {
        "type": "string",
        "description": "Event abstract/description. Derived from ICS DESCRIPTION unless content enrichment is enabled. Newlines may be normalized depending on configuration."
      },
      "title": {
        "type": "string",
        "description": "Optional title populated via enrichment (subtitle) or fallback from speaker; may be empty when enrichment is disabled."
      },
      "cancelled": {
        "type": "string",
        "description": "Placeholder field for cancellation status (currently empty string)."
      },
      "bannerImage": {
        "type": "string",
        "description": "Placeholder field for hero image URL (currently empty string)."
      },
      "itemType": {
        "type": "string",
        "enum": ["advertisement"],
        "description": "Static item type placeholder."
      },
      "rawEventDetails": {
        "type": "string",
        "description": "Optional inner HTML fragment from .events-detail-main of the event page."
      }
    }
  }
}
